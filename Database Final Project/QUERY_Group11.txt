--2ND DOCUMENT BEGIN
--begin update statements with outputs to show before and after changes:

SELECT * FROM USER_ACCOUNT WHERE USER_ID = 987654;
UPDATE USER_ACCOUNT SET PASSWORD = 'new_password1' WHERE USER_ID = 987654; 
UPDATE USER_ACCOUNT SET AGE = 28 WHERE USER_ID = 987654; 
SELECT * FROM USER_ACCOUNT WHERE USER_ID = 987654;

SELECT * FROM PASS WHERE USER_ID = 135790;
UPDATE PASS SET PRICE = 50 WHERE  USER_ID = 135790; 
UPDATE PASS SET THIRTY_DAY = 1, ALL_DAY = 0 WHERE  USER_ID = 135790; 
SELECT * FROM PASS WHERE USER_ID = 135790;

SELECT * FROM TICKET;
UPDATE TICKET SET DISCOUNT = 1, SINGLE = 0 WHERE USER_ID IN (SELECT USER_ID FROM USER_ACCOUNT WHERE DISABILITY = 1);
UPDATE TICKET SET PRICE = 1 WHERE DISCOUNT = 1; 
SELECT * FROM TICKET;

SELECT * FROM CITY;
UPDATE CITY SET COUNTY = 'HILLSBOROUGH' WHERE NAME = 'Tampa'; 
UPDATE CITY SET ZIP = 33803 WHERE CITY_ID = 002002; 
SELECT * FROM CITY;

SELECT * FROM ROUTES WHERE ROUTE_ID = 101001 OR ROUTE_ID = 302001;
UPDATE ROUTES SET NUM_STOPS = 8 WHERE ROUTE_ID = 302001; 
UPDATE ROUTES SET DISTANCE = 38, DIRECTION = 'Northbound' WHERE NUM_STOPS > 25; 
SELECT * FROM ROUTES WHERE ROUTE_ID = 101001 OR ROUTE_ID = 302001;

SELECT * FROM BUS WHERE BUS_ID = 123456;
UPDATE BUS SET SERVICE_DATE = '04-FEB-23' WHERE BUS_ID = 123456; 
UPDATE BUS SET MILEAGE = 95000, CITY_ID = 001001 WHERE DRIVER_ID = 000001; 
SELECT * FROM BUS WHERE BUS_ID = 123456;

SELECT * FROM STOPS WHERE STOP_ID = 002011;
UPDATE STOPS SET Arrival_Time = '03-MAY-23 8:01:00 AM', Departure_Time = '03-MAY-23 8:04:00 AM' WHERE STOP_ID = 002011; 
UPDATE STOPS SET LATITUDE = '28.042535', LONGITUDE = '-81.955435' WHERE STOP_ID = 002011; 
SELECT * FROM STOPS WHERE STOP_ID = 002011;

SELECT * FROM PASSENGER WHERE PASSENGER_ID = 39;
UPDATE PASSENGER SET USE_TIME = '03-MAY-23' WHERE PASSENGER_ID = 39;
UPDATE PASSENGER SET BUS_ID= 123464 WHERE PASSENGER_ID = 39; 
SELECT * FROM PASSENGER WHERE PASSENGER_ID = 39;



-- Referential Constraint 

INSERT INTO TICKET (TIX_ID, USER_ID, SINGLE, DISCOUNT, TRANSFER, PRICE) 

VALUES (1, 1, 1, 0, 0, 2); 

-- Check Constraint 

INSERT INTO USER_ACCOUNT (USER_ID, USERNAME, PASSWORD, F_NAME, L_NAME, CREATION_DATE, DISABILITY, AGE) 

VALUES (1, 'johndoe', 'password', 'J0hn', 'Doe', '2022-01-01', 0, 30); 

-- Not Null Constraint 

INSERT INTO CITY(CITY_ID, NAME, ZIP, COUNTY) 

VALUES(4, NULL, ‘33647’, ‘Hillsborough’); 



--3RD DOCUMENT QUERY BEGINS

SELECT EXTRACT(MONTH FROM CREATION_DATE) AS month_created, COUNT(*) AS num_accounts_created
FROM USER_ACCOUNT
GROUP BY EXTRACT(MONTH FROM CREATION_DATE)
ORDER BY num_accounts_created DESC;

SELECT p.BUS_ID, COUNT(CASE WHEN u.DISABILITY = 1 THEN 1 ELSE NULL END) AS DISABLED_PASSENGERS
FROM PASSENGER p
JOIN USER_ACCOUNT u ON p.USER_ID = u.USER_ID
JOIN BUS b ON p.BUS_ID = b.BUS_ID
GROUP BY p.BUS_ID
ORDER BY DISABLED_PASSENGERS DESC;

SELECT CITY.NAME, COUNT(BUS.BUS_ID) AS BUS_COUNT
FROM CITY
JOIN BUS ON CITY.CITY_ID = BUS.CITY_ID
GROUP BY CITY.NAME
ORDER BY BUS_COUNT DESC;



SELECT AVG(age) AS avg_age FROM user_account;

SELECT BUS_ID, CITY_ID 
FROM BUS 
WHERE MILEAGE = (SELECT MAX(MILEAGE) FROM BUS);

SELECT COUNT(P.USER_ID) AS TOTAL_PASS_HOLDER, SUM(P.THIRTY_DAY) AS TOTAL_30DAY_PASS_HOLDER, SUM(P.SEVEN_DAY) AS TOTAL_7DAY_PASS_HOLDER, SUM(P.ALL_DAY)
AS ALL_DAY_PASS_HOLDER FROM PASS P;

SELECT R.ROUTE_ID, COUNT(*) AS num_passengers FROM PASSENGER P JOIN BUS B ON P.BUS_ID = B.BUS_ID 
JOIN ROUTES R ON R.ROUTE_ID = B.ROUTE_ID WHERE R.NUM_STOPS = (SELECT MAX(NUM_STOPS) FROM ROUTES) GROUP BY R.ROUTE_ID, R.NUM_STOPS;

SELECT CITY.NAME, COUNT(DISTINCT(BUS.BUS_ID)) AS NUM_BUSES , COUNT(PASSENGER.PASSENGER_ID) AS NUM_PASSENGERS 
FROM CITY JOIN BUS ON CITY.CITY_ID = BUS.CITY_ID JOIN ROUTES ON BUS.ROUTE_ID = ROUTES.ROUTE_ID 
JOIN PASSENGER ON BUS.BUS_ID = PASSENGER.BUS_ID GROUP BY CITY.NAME;